<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>
    <%= user.username.endsWith('s') ? user.username + "' Budget Charts" : user.username + "'s Budget Charts" %>
  </title>
  <link rel="icon" href="/images/logo.png" type="image/png" />
  <link rel="stylesheet" href="https://unpkg.com/bulmaswatch/flatly/bulmaswatch.min.css">
  <style>
    .input:active,
    .input:focus,
    .is-active.input,
    .is-active.textarea,
    .is-focused.input,
    .is-focused.textarea,
    .select select.is-active,
    .select select.is-focused,
    .select select:active,
    .select select:focus,
    .textarea:active,
    .textarea:focus {
      border-color: #34495e !important;
      box-shadow: 0 0 0 .125em #34495e33 !important;
    }
    .select:not(.is-multiple):not(.is-loading)::after {
      border-color: #238cd1;
    }
  </style>
</head>

<body>
  <%- include('../partials/_navbar.ejs') %>
    <section class="section">
      <div class="container" style="max-width: 600px;">
        <h1 class="title is-1 has-text-centered">Financial Data</h1>
        <%- include('../partials/_links.ejs') %>
          <div class="box" style="margin-top: 1.25rem;">
            <div class="content">
              <h2 class="title is-4 has-text-centered">Monthly Cost By Category</h2>
              <div class="container is-flex is-flex-direction-column" style="width: 400px;">
                <canvas id="pie-chart"></canvas>
              </div>
            </div>
            <div class="content">
              <p class="title is-3 has-text-centered">Estimates</p>
              <div id="total-cost">
                <span class="has-text-weight-bold">Estimated Total:</span>
              </div>
              <div id="estimate-cost">
                <span class="has-text-weight-bold">Confidence Estimate:</span>
              </div>
            </div>
            <div class="field is-grouped is-grouped-centered buttons are-medium">
              <button class="button is-primary" onclick="changeSchedule('Weekly')">Weekly</button>
              <button class="button is-primary" onclick="changeSchedule('Monthly')">Monthly</button>
              <button class="button is-primary" onclick="changeSchedule('Quarterly')">Quarterly</button>
              <button class="button is-primary" onclick="changeSchedule('Annually')">Annually</button>
            </div>
          </div>
      </div>
    </section>
    <script>
      window.currency = JSON.parse(
        `<%- JSON.stringify(currentUser.currency) %>`
      );
      window.expense = JSON.parse(`<%- JSON.stringify(currentUser.budget) %>`);
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script defer src="/js/clientUtils.js"></script>
</body>

</html>